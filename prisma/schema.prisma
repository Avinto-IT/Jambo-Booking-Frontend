generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Hotel {
  hotelID          String    @id @default(auto()) @map("_id") @db.ObjectId
  name             String
  address          String
  locationID       String    @db.ObjectId
  facilities       Json
  description      String
  houseRules       Json
  imageLinks       String[]
  primaryImageLink String
  isRunning        Boolean
  rooms            Json
  discount         Float
  contactDetails   Json
  addedDate        DateTime
  location         Location  @relation(fields: [locationID], references: [locationID])
  bookings         Booking[]
  User             User[]
}

model Blog {
  blogID       String   @id @default(auto()) @map("_id") @db.ObjectId
  title        String
  primaryImage String
  content      String
  caption      String
  createdAt    DateTime
  imageLinks   String[]
  userId       String
}

model Grade {
  gradeID       String @id @default(auto()) @map("_id") @db.ObjectId
  gradeName     String
  priceModifier String

  User User[]
}

model User {
  userID           String           @id @default(auto()) @map("_id") @db.ObjectId
  agencyName       String?
  firstName        String
  lastName         String
  password         String
  email            String           @unique
  affiliatedHotel  String?
  contactNumber    String
  role             String //This will be either a) Hotel b) Agent c) Jambo(Admin)
  dateOfBirth      DateTime
  address          String
  toursCompleted   Int?
  bookings         Booking[]
  bookingHistories BookingHistory[]
  gradeID          String?          @db.ObjectId
  grade            Grade?           @relation(fields: [gradeID], references: [gradeID])
  hotelID          String?          @db.ObjectId
  hotel            Hotel?           @relation(fields: [hotelID], references: [hotelID])
}

model Location {
  locationID String  @id @default(auto()) @map("_id") @db.ObjectId
  city       String
  country    String
  address    String
  zipCode    String
  hotels     Hotel[]
}

model Booking {
  bookingID        String           @id @default(auto()) @map("_id") @db.ObjectId
  userID           String           @db.ObjectId
  hotelID          String           @db.ObjectId
  bookingStartDate DateTime
  bookingEndDate   DateTime
  requestedDate    DateTime
  status           String
  guests           Int
  bookingInfo      Json
  user             User             @relation(fields: [userID], references: [userID])
  hotel            Hotel            @relation(fields: [hotelID], references: [hotelID])
  bookingHistory   BookingHistory[]
}

model BookingHistory {
  bookingID String @id @default(auto()) @map("_id") @db.ObjectId
  count     Int

  booking Booking @relation(fields: [bookingID], references: [bookingID])
  userID  String  @db.ObjectId
  user    User    @relation(fields: [userID], references: [userID])
}

model HouseRules {
  houseRuleId String @id @default(auto()) @map("_id") @db.ObjectId
  houseRule   String
}

model Facilities {
  facilityId       String @id @default(auto()) @map("_id") @db.ObjectId
  facilityCategory String
  subFacilities    Json
}
